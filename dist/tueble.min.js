/*!
* tueble v1.4.0
* (c) 2019 Marcos Freire
* @license MIT
*/
!function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function i(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t,e){return Object.assign.apply(Object,[{}].concat(i(e.map(function(e){return e in t?function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},e,t[e]):{}}))))}var s=function t(n){e(this,t);var r=o(n,["show","sortable","filterable","columnClass","label","index","highlight","columnHeaderClass"]);for(var i in r)this[i]=n[i];this.index&&(this.sortable=!1,this.filterable=!1,this.highlight=!1),this.isActive=!1,this.sortOrder=1,this.template=n.$scopedSlots.default},l=function(){function t(n,r){e(this,t),this.filterText=n,this.filterMinSize=r}return r(t,[{key:"isValid",value:function(){return"string"==typeof this.filterText&&this.filterText.length>=this.filterMinSize}}]),t}(),a=function(){function t(n){e(this,t);var r=o(n,["filterBy","filterColumn"]);for(var i in r)this[i]=n[i]}return r(t,[{key:"isValid",value:function(){return this.filterBy.constructor===Array&&this.filterBy.length>0&&"string"==typeof this.filterColumn}}]),t}();var u=function(t,e,n,r,i,o,s,l,a,u){"boolean"!=typeof s&&(a=l,l=s,s=!1);var c,d="function"==typeof n?n.options:n;if(t&&t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,i&&(d.functional=!0)),r&&(d._scopeId=r),o?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,a(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},d._ssrRegister=c):e&&(c=s?function(){e.call(this,u(this.$root.$options.shadowRoot))}:function(t){e.call(this,l(t))}),c)if(d.functional){var f=d.render;d.render=function(t,e){return c.call(e),f(t,e)}}else{var h=d.beforeCreate;d.beforeCreate=h?[].concat(h,c):[c]}return n};var c=u({render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",t._l(t.columns,function(e){return n("tu-cell",{key:e.id,attrs:{column:e,"row-data":t.rowData,"row-index":t.rowIndex,"text-search":t.filterText}})}))},staticRenderFns:[]},void 0,{components:{"tu-cell":{functional:!0,props:["column","rowData","rowIndex","textSearch"],render:function(t,e){var n=e.props,r={};if(n.column.columnClass&&(r.class=n.column.columnClass),!n.column.index&&n.column.template)return t("td",r,n.column.template(n.rowData));r.domProps={};var i,o,s=n.column.index?n.rowIndex+1:n.column.highlight?(i=n.rowData[n.column.show],(o=n.textSearch)?i.toString().replace(new RegExp(o,"gi"),function(t){return'<span class="highlight">'+t+"</span>"}):i):n.rowData[n.column.show];return r.domProps.innerHTML=s,t("td",r)}}},props:{rowIndex:{required:!0,type:Number},columns:{required:!0,type:Array},rowData:{required:!0,type:Object},filterText:{required:!1,type:String,default:""}},computed:{showData:function(){return this}}},void 0,!1,void 0,void 0,void 0);var d=u({render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("th",{class:t.classNames,on:{click:t.clickAction}},[t._v("\n  "+t._s(t.column.label)+"\n  "),t.column.isActive?n("span",{domProps:{innerHTML:t._s(t.sortIcon)}}):t._e()])},staticRenderFns:[]},void 0,{props:{column:{required:!0,type:Object},columnIndex:{type:Number}},computed:{classNames:function(){return this.column.columnHeaderClass+(this.column.isActive?" header-active":"")+(this.column.index?" header-index":"")},sortIcon:function(){return 1==this.column.sortOrder?"&#9660;":"&#9650;"}},methods:{clickAction:function(){this.column.index||this.$emit("sortUpdate",this.columnIndex)}}},void 0,!1,void 0,void 0,void 0),f=new(function(){function t(){e(this,t)}return r(t,[{key:"filterArray",value:function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],s=this.pluck(r.filter(function(t){return t.filterable}),"show");i.isValid()&&(t=t.filter(function(t){return Object.keys(t).filter(function(t){return s.includes(t)}).some(function(e){return String(t[e]).toLowerCase().indexOf(i.filterText)>=0})})),o.filter(function(t){return t.isValid()}).forEach(function(e){t=t.filter(function(t){return e.filterBy.includes(t[e.filterColumn])})}),e&&(t=t.slice().sort(function(t,r){return((t=t[e])===(r=r[e])?0:t>r?1:-1)*n}));var l=0;return t=t.map(function(t){return t._id=l++,t})}},{key:"pluck",value:function(t,e){return t.reduce(function(t,n){return t.concat(n[e])},[])}}]),t}());var h=u({render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tueble-component"},[n("table",{class:t.tableClass},[t.showCaption?n("caption"):t._e(),t._v(" "),0==t.filteredAndSortedData.length?n("p",{staticClass:"no-results"},[t._v(t._s(t.noDataText))]):t._e(),t._v(" "),n("thead",[n("tr",t._l(t.columns,function(e,r){return n("tu-column-header",{key:e.id,attrs:{column:e,"column-index":r},on:{sortUpdate:t.updateSortColumn}})}))]),t._v(" "),n("tbody",{class:t.tableBodyClass},t._l(t.filteredAndSortedData,function(e,r){return n("tu-row",{key:e._id,attrs:{columns:t.columns,"row-index":r,"row-data":e,"filter-text":t.filterText}})}))]),t._v(" "),n("div",{staticStyle:{display:"none"}},[t._t("default")],2)])},staticRenderFns:[]},void 0,{components:{"tu-row":c,"tu-column-header":d},props:{data:{required:!0,type:Array},showCaption:{required:!1,type:Boolean,default:!0},tableClass:{required:!1,type:String},tableBodyClass:{required:!1,type:String},filterText:{required:!1,type:String,default:""},filterMinSize:{required:!1,type:Number,default:2},defaultSortBy:{required:!1,type:String},defaultSortOrder:{required:!1,default:"asc",validator:function(t){return["asc","desc"].includes(t)}},noDataText:{required:!1,type:String,default:"No results found."}},data:function(){return{columns:[],domainFilters:[],orderBy:null,orderAscDesc:1}},mounted:function(){this.columns=this.mapVueComponentsToObjects("tu-column","Column"),this.domainFilters=this.mapVueComponentsToObjects("filter-by-domain","DomainFilter"),this.defaultSortBy&&(this.orderBy=this.defaultSortBy,this.setDefaultColumn(this.defaultSortBy)),this.$on("filter-by-domain-changed",function(t){this.domainFilters=this.mapVueComponentsToObjects("filter-by-domain","DomainFilter")})},computed:{filteredAndSortedData:function(){var t=this.data,e=this.orderBy,n=this.orderAscDesc,r=new l(this.filterText,this.filterMinSize),i=this.domainFilters;return f.filterArray(t,e,n,this.columns,r,i)}},methods:{updateSortColumn:function(t){for(var e=0;e<this.columns.length;e++)e==t?(this.columns[e].isActive&&(this.columns[e].sortOrder=-1*this.columns[e].sortOrder),this.columns[e].isActive=!0,this.orderBy=this.columns[e].show,this.orderAscDesc=this.columns[e].sortOrder):this.columns[e].isActive=!1},setDefaultColumn:function(t){var e=this;this.columns.forEach(function(n){n.show==t&&(n.isActive=!0,"asc"==e.defaultSortOrder&&(n.sortOrder=1),"desc"==e.defaultSortOrder&&(n.sortOrder=-1),e.orderAscDesc=n.sortOrder)})},mapVueComponentsToObjects:function(t,e){var n={Column:s,DomainFilter:a};return this.$children.filter(function(e){return e.$options.name==t}).map(function(t){return new n[e](t)})}}},void 0,!1,void 0,void 0,void 0);var m=u({render:function(){this.$createElement;this._self._c;return this._e()},staticRenderFns:[]},void 0,{name:"tu-column",props:{show:{type:String,required:!1},sortable:{type:Boolean,default:!0},filterable:{type:Boolean,default:!0},index:{type:Boolean,default:!1,required:!1},highlight:{type:Boolean,default:!1,required:!1},label:{type:String,required:!0},columnClass:{type:String,default:""},columnHeaderClass:{type:String,default:""}}},void 0,!1,void 0,void 0,void 0);var p=u({render:function(){this.$createElement;this._self._c;return this._e()},staticRenderFns:[]},void 0,{name:"filter-by-domain",props:{filterBy:{required:!0,type:Array,default:""},filterColumn:{required:!0,type:String}},watch:{filterBy:function(){this.$parent.$emit("filter-by-domain-changed",this.filterBy)}}},void 0,!1,void 0,void 0,void 0),y=Object.freeze({Tueble:h,Column:m,FilterByDomain:p});function v(t,e){return e?t.toString().replace(new RegExp(e,"gi"),function(t){return'<span class="highlight">'+t+"</span>"}):t}var b={install:function t(e){t.installed||(t.installed=!0,Object.keys(y).forEach(function(t){e.component(t,y[t])}),e.filter("highlight",v))}},g=null;"undefined"!=typeof window?g=window.Vue:"undefined"!=typeof global&&(g=global.Vue),g&&g.use(b),t.Column=m,t.FilterByDomain=p,t.HighlightText=v,t.Tueble=h,t.default=b}({});
